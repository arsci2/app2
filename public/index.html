<!DOCTYPE html>
<html>
<head>
    <link rel="icon" href="https://nameless-taiga-88242.herokuapp.com/KOLuHYOrXW8T324wQ4OM.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Light Sensor Information</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="/chart/dist/Chart.bundle.js"></script>
    <style>
        body {
            padding-top: 60px;
        }
    </style>
	<script>
		function defaultView(){
			$("#dataview").hide();
			$("#recent").show();
			$("#list").show();
			$("#exit").hide();
			$("#listpage").hide();
		}
	</script>		
    <script>
	$(function() {
	    $("#reload").submit(function(event){
		event.preventDefault();
		location.reload();		
	    });
	});
	$(function() {
	    $("#listing").submit(function(event){
		event.preventDefault();
		$("#recent").hide();
		$("#dataview").hide();
		$("#list").hide();
		$("#exit").show();
		$("#listpage").show();

		$.ajax({
                    url: event.target.action,
                    method: event.target.method,
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function(data) {
						$("#val1").text(data.rows[0].name__c);
						$("#val2").text(data.rows[1].name__c);
						$("#val3").text(data.rows[2].name__c);
						$("#val4").text(data.rows[3].name__c);
						$("#val5").text(data.rows[4].name__c);
						$("#val6").text(data.rows[5].name__c);
						$("#val7").text(data.rows[6].name__c);
						$("#val8").text(data.rows[7].name__c);
						$("#val9").text(data.rows[8].name__c);
						$("#val10").text(data.rows[9].name__c);
						$("#val11").text(data.rows[10].name__c);
						$("#val12").text(data.rows[11].name__c);
						$("#val13").text(data.rows[12].name__c);
						$("#val14").text(data.rows[13].name__c);
						$("#val15").text(data.rows[14].name__c);
						$("#val16").text(data.rows[15].name__c);
						$("#val17").text(data.rows[16].name__c);
						$("#val18").text(data.rows[17].name__c);
						$("#val19").text(data.rows[18].name__c);
						$("#val20").text(data.rows[19].name__c);

						$("#aval1").text(data.rows[0].sensorvalue__c);
						$("#aval2").text(data.rows[1].sensorvalue__c);
						$("#aval3").text(data.rows[2].sensorvalue__c);
						$("#aval4").text(data.rows[3].sensorvalue__c);
						$("#aval5").text(data.rows[4].sensorvalue__c);
						$("#aval6").text(data.rows[5].sensorvalue__c);
						$("#aval7").text(data.rows[6].sensorvalue__c);
						$("#aval8").text(data.rows[7].sensorvalue__c);
						$("#aval9").text(data.rows[8].sensorvalue__c);
						$("#aval10").text(data.rows[9].sensorvalue__c);
						$("#aval11").text(data.rows[10].sensorvalue__c);
						$("#aval12").text(data.rows[11].sensorvalue__c);
						$("#aval13").text(data.rows[12].sensorvalue__c);
						$("#aval14").text(data.rows[13].sensorvalue__c);
						$("#aval15").text(data.rows[14].sensorvalue__c);
						$("#aval16").text(data.rows[15].sensorvalue__c);
						$("#aval17").text(data.rows[16].sensorvalue__c);
						$("#aval18").text(data.rows[17].sensorvalue__c);
						$("#aval19").text(data.rows[18].sensorvalue__c);
						$("#aval20").text(data.rows[19].sensorvalue__c);

						
					}
                })
		
	    });
	});
        $(function() {
            $("#phoneChangerForm").submit(function(event) {
		event.preventDefault();
                $.ajax({
                    url: event.target.action,
                    method: event.target.method,
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function(data) {
						$("#sensorvalue").text(data.rows[0].sensorvalue__c);
						$("#sensortimestamp").text(data.rows[0].sensortimestamp__c);
						$("#id").text(data.rows[0].id);
						$("#name").text(data.rows[0].name);
						$("#deviceuser").text(data.rows[0].deviceuser__c);
						$("#deviceos").text(data.rows[0].deviceos__c);
						$("#loginuname").text(data.rows[0].loginuname__c);
						$("#devicename").text(data.rows[0].devicename__c);
						$("#_hc_lastop").text(data.rows[0]._hc_lastop);
						$("#mcuinfo").text(data.rows[0].mcuinfo__c);
						$("#deviceipint").text(data.rows[0].deviceipint__c);
						$("#deviceipext").text(data.rows[0].deviceipext__c);
						$("#localtime").text(data.rows[0].localtimestamppst__c);
						$("#sensorinfo").text(data.rows[0].sensorinfo__c);
						
						$("#dataview").show();
						$("#exit").show();
						$("#list").hide();
						$("#recent").hide();
						$("#listpage").hide();
						
						var labels1 = [];
						var data1 = [];
						for(var l=0; l<20; l++){
							data1[l] = (data.rows[l].sensorvalue__c);
							labels1[l] = (data.rows[l].localtimestamppst__c);
						}
						labels1[0] = "Current: " + labels1[0];

						
					

						var ctx = document.getElementById("myChart").getContext("2d");
						ctx.canvas.height = 50;
						var myChart = new Chart(ctx , {
							responsive: 'true',
							type: 'line',
							data: { 
								labels: labels1,
								datasets:[{
									label: 'Light Intensity (LUX)',
									pointColor: 'rgba(250,135,20,1)',
									fillColor: 'rgba(125,150,245,1)',
									highlightFill: 'rgba(125,150,245,1)',
									data: data1
								}]
							},
							options: {
								hover: {
									mode: 'label'
								},
								title: {
									display: true,
									text: 'Last 20 Brightness Values (Hover over points to show details)'
								},
								scales: {
									yAxes: [{
										ticks: {
											min: 40,
											max: 60
										}
									}],
									xAxes: [{
										display: false
									}]
								}
							}
						});
						myChart.update(2000);	
					}
                })
            });
        });
    </script>
</head>
<body onload = "defaultView()">
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="/">Light Sensor Information</a>
            </div>
        </div>
    </nav>
    <div class="container">
		<div class="panel panel-default">
			<div class="panel-heading">
                <h3 class="panel-title"></h3>
				<form id="phoneChangerForm" action="/update" method="get" style="width: 400px">
					<div id="recent">
						<button type="submit" class="btn btn-primary">Load Recent Data</button>
						<br><br>
					</div>
				</form>
					
				<form id="reload" action="/update" method="get" style="width: 400px">
					<div id="exit">
						<button type="submit" class="btn btn-primary">Exit</button>
						<br><br>
					</div>
				</form>
					
				<form id="listing" action="/update" method="get" style="width: 400px">
					<div id="list">
						<button type="submit" class="btn btn-primary">List Recent Entries</button>
						<br><br>
					</div>
				</form>
            </div>
	    
	    <div class="panel-body" id="listpage">
	    <label for="listpage1">Listing</label>
		<br><div id="val1"></div>:<div id="aval1"></div>
		<br><div id="val2"></div>:<div id="aval2"></div>
		<br><div id="val3"></div>:<div id="aval3"></div>
		<br><div id="val4"></div>:<div id="aval4"></div>
		<br><div id="val5"></div>:<div id="aval5"></div>
		<br><div id="val6"></div>:<div id="aval6"></div>
		<br><div id="val7"></div>:<div id="aval7"></div>
		<br><div id="val8"></div>:<div id="aval8"></div>
		<br><div id="val9"></div>:<div id="aval9"></div>
		<br><div id="val10"></div>:<div id="aval10"></div>
		<br><div id="val11"></div>:<div id="aval11"></div>
		<br><div id="val12"></div>:<div id="aval12"></div>
		<br><div id="val13"></div>:<div id="aval13"></div>
		<br><div id="val14"></div>:<div id="aval14"></div>
		<br><div id="val15"></div>:<div id="aval15"></div>
		<br><div id="val16"></div>:<div id="aval16"></div>
		<br><div id="val17"></div>:<div id="aval17"></div>
		<br><div id="val18"></div>:<div id="aval18"></div>
		<br><div id="val19"></div>:<div id="aval19"></div>
		<br><div id="val20"></div>:<div id="aval20"></div>
	    </div>
	    
            <div class="panel-body" id="dataview">
                <div class="form-group" id="sv">
                    <label for="sensorvalue">Brightness Level (LUX):</label>
                    <div id="sensorvalue">
                </div><br>
				<div class="form-group" id="lt">
                    <label for="localtime">Local Timestamp (PST): </label>
                    <div id="localtime">
					
                </div><br>
                <div class="form-group" id="st">
                    <label for="sensortimestamp">Database Timestamp (GMT): </label>
                    <div id="sensortimestamp">
                </div><br>
				<div class="form-group" id="did">
                    <label for="id">Database Record ID Number: </label>
                    <div id="id">
                </div><br>
				<div class="form-group" id="dn">
                    <label for="name">Database Record Name:</label>
                    <div id="name">
                </div><br>
				<div class="form-group" id="du">
                    <label for="deviceuser">Device Username (Sensor PC): </label>
                    <div id="deviceuser">
                </div><br>
				<div class="form-group" id="ipi">
                    <label for="deviceipext">Device IP (External) (Sensor PC): </label>
                    <div id="deviceipext">
                </div><br>
				<div class="form-group" id="ipe">
                    <label for="deviceipint">Device IP (Internal) (Sensor PC): </label>
                    <div id="deviceipint">
                </div><br>
				<div class="form-group" id="os">
                    <label for="deviceos">Device Information (Sensor PC): </label>
                    <div id="deviceos">
                </div><br>
				<div class="form-group" id="syn">
                    <label for="_hc_lastop">Database Sync Status (Salesforce/Heroku): </label>
                    <div id="_hc_lastop">
                </div><br>
				<div class="form-group" id="mcu">
                    <label for="mcuinfo">Microcontroller (MCU) Information: </label>
                    <div id="mcuinfo">
                </div><br>
				<div class="form-group" id="sens">
                    <label for="sensorinfo">Sensor Information: </label>
                    <div id="sensorinfo">
                </div>				
            	<div class="form-group" id="gv">
					<canvas id="myChart" width="100" height="100"></canvas>
		</div>
	     </div>	
        </div>
    </div>
</body>
</html>